<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>After School Club — White & Sage Theme with Stock</title>

  <script src="https://cdn.jsdelivr.net/npm/vue@2.7.16/dist/vue.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">


  <style>
    :root{
      /* White & Sage Theme */
      --bg: #f8f9fa;
      --panel: #ffffff;
      --muted: #6c757d;
      --card: linear-gradient(180deg,#ffffff,#f0f2f5);
      --accent: #6b8e23; /* Sage Green */
      --accent-strong: #5a7a1b;
      --glass-border: rgba(0,0,0,0.08);
      --text-color: #212529;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: "Poppins", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: var(--bg);
      color: var(--text-color);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.4;
    }

    /* Header */
    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:18px 28px;
      border-bottom: 2px solid rgba(107,142,35,0.15);
      background: linear-gradient(90deg, rgba(107,142,35,0.08), rgba(255,255,255,0));
      color: var(--text-color);
    }
    header h1{margin:0;font-size:20px;color:var(--accent);letter-spacing:0.6px}
    .cart-btn{
      display:inline-flex;
      gap:8px;
      align-items:center;
      background:transparent;
      color:var(--accent);
      border:1px solid rgba(107,142,35,0.15);
      padding:8px 12px;
      border-radius:8px;
      cursor:pointer;
      transition:all .18s;
    }
    .cart-btn:hover{background:rgba(107,142,35,0.08)}

    main{padding:28px;display:flex;flex-direction:column;align-items:center;gap:22px}

    /* Tabs */
    .tabs{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;align-items:center}
    .tab{
      padding:10px 18px;border-radius:999px;background:transparent;border:1px solid var(--glass-border);
      color:var(--muted);cursor:pointer;font-weight:600;transition:all .16s;
    }
    .tab.active{
      background: linear-gradient(90deg, rgba(107,142,35,0.18), rgba(90,122,27,0.08));
      color: var(--text-color);
      box-shadow: 0 6px 18px rgba(107,142,35,0.1);
      border-color: rgba(107,142,35,0.2)
    }

    /* Grid */
    .grid{
      width:100%;
      max-width:1200px;
      display:grid;
      grid-template-columns: repeat(4,1fr);
      gap:20px;
    }
    @media (max-width:1000px){ .grid{ grid-template-columns: repeat(3,1fr) } }
    @media (max-width:720px){ .grid{ grid-template-columns: repeat(2,1fr) } }
    @media (max-width:480px){ .grid{ grid-template-columns: 1fr } }

    .card{
      background: var(--card);
      border-radius:14px;
      padding:18px;
      border:1px solid var(--glass-border);
      box-shadow: 0 6px 18px rgba(0,0,0,0.1);
      text-align:center;
      transition: transform .18s, box-shadow .18s;
    }
    .card:hover{ transform: translateY(-6px); box-shadow: 0 14px 30px rgba(107,142,35,0.15) }

    .icon{ font-size:42px; color:var(--accent); margin-bottom:10px }
    .card h3{ margin:6px 0 6px;font-size:16px;color:var(--text-color) }
    .card p{ margin:6px 0;color:var(--muted); font-size:13px }
    
    .stock-info{
        font-size: 12px;
        font-weight: 500;
        margin: 4px 0;
    }
    .stock-info.low{ color: #d9534f; } /* Red for low/out of stock */
    .stock-info.high{ color: var(--accent-strong); } /* Sage green for high stock */

    .card .price{ font-weight:700;color:var(--text-color);margin-top:8px }
    .add-btn{
      margin-top:12px;
      width:100%;
      padding:10px 12px;
      border-radius:10px;
      background:linear-gradient(180deg,var(--accent),var(--accent-strong));
      color:white;border:none;cursor:pointer;font-weight:700;
      transition: transform .12s, box-shadow .12s;
    }
    .add-btn:hover{ transform: translateY(-2px); box-shadow: 0 8px 20px rgba(107,142,35,0.15) }
    .add-btn:disabled{
        background: #ced4da; /* Light gray when disabled */
        cursor: not-allowed;
        box-shadow: none;
        transform: none;
    }

    /* Checkout layout (left form, right cart) */
    .checkout-wrap{
      width:100%;
      max-width:1200px;
      display:flex;
      gap:24px;
      align-items:flex-start;
      justify-content:center;
      padding:20px;
    }
    .checkout-left, .checkout-right{
      border-radius:12px;
      background: var(--panel);
      border:1px solid var(--glass-border);
      padding:20px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.08);
    }
    .checkout-left{ flex:1; min-width:320px }
    .checkout-right{ width:380px; min-width:260px }

    .section-title{ color:var(--accent); font-weight:700; margin-bottom:12px; font-size:18px }

    label{ font-size:13px;color:var(--muted); display:block; margin-bottom:6px;font-weight:600 }
    input[type="text"], input[type="email"], input[type="tel"], select{
      width:100%; padding:10px 12px; border-radius:8px; border:1px solid rgba(0,0,0,0.1); background:#f0f2f5;
      color:var(--text-color); margin-bottom:14px;
    }
    input::placeholder { color: #a0a0a0; }


    .place-order-btn{
      margin-top:10px;
      width:100%;
      padding:11px 12px;
      border-radius:10px;
      background: linear-gradient(180deg,var(--accent),var(--accent-strong));
      color:white;border:none;cursor:pointer;font-weight:800;
      box-shadow: 0 10px 22px rgba(107,142,35,0.1);
    }
    .place-order-btn:hover{ filter:brightness(.98) }

    /* Cart items */
    .cart-list{ display:flex;flex-direction:column; gap:10px }
    .cart-item{
      display:flex;align-items:center;justify-content:space-between;gap:10px;padding:10px;border-radius:8px;
      background: #f0f2f5;
      border:1px solid rgba(0,0,0,0.05);
    }
    .cart-item .left{ display:flex;flex-direction:column; gap:6px; }
    .cart-item .title{ font-weight:700; color:var(--text-color); font-size:14px }
    .cart-item .meta{ font-size:13px; color:var(--muted) }
    .cart-item .price{ font-weight:800; color:var(--text-color) }
    .remove-btn{
      background:transparent;border:1px solid rgba(107,142,35,0.15); color:var(--accent); padding:6px 8px;border-radius:8px;cursor:pointer;
    }
    .remove-btn:hover{ background: rgba(107,142,35,0.08) }

    .total-row{ display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px dashed rgba(0,0,0,0.1);margin-top:10px }
    .total-row .label{ color:var(--muted); font-weight:700 }
    .total-row .value{ font-weight:900;color:var(--text-color) }

    /* Order Summary page (After 'Place Order') */
    .order-summary{
      width:100%;
      max-width:900px;
      background: var(--panel);
      border-radius:12px;
      padding:28px;
      border:1px solid var(--glass-border);
      margin:18px auto;
      box-shadow: 0 8px 20px rgba(0,0,0,0.1);
    }
    .order-summary h2{ color:var(--accent); margin:0 0 14px 0; border-bottom: 2px solid rgba(107,142,35,0.15); padding-bottom:10px }

    .order-info-grid{
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-bottom: 20px;
    }
    .info-block-summary{
      background:#f0f2f5;
      padding:15px;
      border-radius:8px;
      border:1px solid rgba(0,0,0,0.05);
      min-width:200px;
    }
    .info-block-summary b{
        display:block;
        color:var(--accent);
        font-size:12px;
        margin-bottom:6px;
        text-transform:uppercase;
        letter-spacing:0.5px;
    }
    .info-block-summary div{
        font-weight:600;
        color:var(--text-color);
    }

    /* Items List in Summary */
    .items-list h3{ color:var(--accent); margin-top:18px; padding-bottom:5px; border-bottom:1px solid rgba(0,0,0,0.08) }
    .summary-item{
        display:flex;
        justify-content:space-between;
        padding:10px 0;
        border-bottom:1px dashed rgba(0,0,0,0.05)
    }
    .summary-item:last-of-type{border-bottom:none;}
    .summary-item .name{font-weight:700; color:var(--text-color)}
    .summary-item .meta{color:var(--muted);font-size:12px}
    .summary-item .price{font-weight:900;color:var(--accent)}

    .summary-total{
        display:flex;
        justify-content:space-between;
        padding-top:14px;
        font-weight:900;
        font-size:16px;
        color:var(--text-color);
        border-top:2px solid var(--accent-strong);
        margin-top:10px;
    }

    .summary-footer{
        text-align: right;
        font-size: 11px;
        color: var(--muted);
        margin-top: 20px;
    }

    /* Page Transitions (Fade & Slide) */
    .fade-slide-enter-active, .fade-slide-leave-active {
        transition: opacity 0.5s ease, transform 0.5s ease;
    }
    .fade-slide-enter, .fade-slide-leave-to {
        opacity: 0;
        transform: translateY(20px);
    }

    /* small screens */
    @media (max-width: 980px){
      .checkout-wrap{ flex-direction:column; align-items:stretch;padding:12px }
      .checkout-right{ width:100% }
    }
  </style>
</head>
<body>
  <div id="app">
    <header>
      <h1>After School Club</h1>
      <button class="cart-btn" @click="openCheckout">
        <i class="fas fa-cart-shopping"></i>
        <span>{{ cartItemCount || 0 }}</span>
      </button>
    </header>

    <main>
      
<transition name="fade-slide" mode="out-in">
        <div v-if="!showCheckout && !showSummary" key="products-view">
          <div class="tabs">
            <button class="tab" :class="{active: currentCategory==='subjects'}" @click="currentCategory='subjects'">Subjects</button>
            <button class="tab" :class="{active: currentCategory==='sports'}" @click="currentCategory='sports'">Sports</button>
            <button class="tab" :class="{active: currentCategory==='activities'}" @click="currentCategory='activities'">Activities</button>
          </div>

          <div class="grid">
            <div v-for="prod in filteredProducts" :key="prod.id" class="card">
              <div class="icon"><i :class="prod.icon"></i></div>
              <h3>{{ prod.subject }}</h3>
              <p>{{ prod.location }}</p>
              <div class="stock-info" :class="{low: prod.stock - prod.inCart === 0}">
                  {{ prod.stock - prod.inCart }} available
              </div>
              <div class="price">AED {{ prod.price }}</div>
              <button class="add-btn" @click="addToCart(prod)" :disabled="!canAddToCart(prod)">
                <i class="fas fa-plus-circle"></i> {{ prod.inCart < prod.stock ? 'Add to cart' : 'Sold Out' }}
              </button>
            </div>
          </div>
        </div>

        <div v-else-if="showCheckout && !showSummary" key="checkout-view" class="checkout-wrap">
          <div class="checkout-left">
            <div class="section-title">Registration Details</div>

            <div>
              <label>Full Name</label>
              <input type="text" placeholder="Student full name" v-model="order.name">

              <div style="display:flex;gap:10px">
                <div style="flex:1">
                  <label>Country</label>
                  <select v-model="order.country">
                    <option disabled value="">Select Country</option>
                    <option>United Arab Emirates</option>
                  </select>
                </div>
                <div style="flex:1">
                  <label>City (Emirate)</label>
                  <select v-model="order.city">
                    <option disabled value="">Select Emirate</option>
                    <option>Dubai</option>
                    <option>Abu Dhabi</option>
                    <option>Sharjah</option>
                    <option>Ajman</option>
                    <option>Umm Al Quwain</option>
                    <option>Ras Al Khaimah</option>
                    <option>Fujairah</option>
                  </select>
                </div>
              </div>

              <label>Year of Study</label>
              <select v-model="order.year">
                  <option disabled value="">Select Year</option>
                  <option v-for="year in 12" :key="year">Year {{ year }}</option>
              </select>

              <label>Student Number</label>
              <input type="text" placeholder="School student number" v-model="order.studentNumber">

              <label>Email</label>
              <input type="email" placeholder="example@mail.com" v-model="order.email">

              <button class="place-order-btn" @click="confirmOrder">Place Order</button>
              <div style="margin-top:10px;text-align:center">
                <button class="place-order-btn" style="background:transparent;border:1px solid rgba(0,0,0,0.1);color:var(--muted); box-shadow:none" @click="closeCheckout">Back to Clubs</button>
              </div>
            </div>
          </div>

          <aside class="checkout-right">
            <div class="section-title">Your Selected Clubs</div>

            <div v-if="cartDetails.length" class="cart-list">
              <div v-for="(item, idx) in cartDetails" :key="idx" class="cart-item">
                <div class="left">
                  <div class="title">{{ item.subject }}</div>
                  <div class="meta">{{ item.category }} • {{ item.location }}</div>
                </div>
                <div style="display:flex;align-items:center;gap:10px">
                  <div class="price">AED {{ item.price }}</div>
                  <button class="remove-btn" @click="removeFromCart(idx)" title="Remove"><i class="fas fa-times"></i></button>
                </div>
              </div>

              <div class="total-row">
                <div class="label">Total</div>
                <div class="value">AED {{ totalPrice }}</div>
              </div>
            </div>

            <div v-else style="color:var(--muted);padding:12px">No items selected yet.</div>
          </aside>
        </div>

        <div v-else-if="showSummary" key="summary-view" class="order-summary">
          <h2>✅ Order Confirmation</h2>

          <div class="order-info-grid">
              <div class="info-block-summary">
                  <b>Student Name</b>
                  <div>{{ order.name || '-' }}</div>
              </div>
              <div class="info-block-summary">
                  <b>Country / Emirate</b>
                  <div>{{ order.country || '-' }} / {{ order.city || '-' }}</div>
              </div>
              <div class="info-block-summary">
                  <b>Year of Study</b>
                  <div>{{ order.year || '-' }}</div>
              </div>
              <div class="info-block-summary">
                  <b>Student ID</b>
                  <div>{{ order.studentNumber || '-' }}</div>
              </div>
              <div class="info-block-summary">
                  <b>Email Address</b>
                  <div>{{ order.email || '-' }}</div>
              </div>
          </div>

          <div class="items-list">
            <h3 style="color:var(--accent);margin-top:18px">Selected Clubs</h3>
            <div v-if="cartDetails.length">
              <div v-for="(it, i) in cartDetails" :key="i" class="summary-item">
                <div>
                  <div class="name">{{ it.subject }}</div>
                  <div class="meta">{{ it.category }} • {{ it.location }}</div>
                </div>
                <div class="price">AED {{ it.price }}</div>
              </div>

              <div class="summary-total">
                <div>Grand Total</div>
                <div>AED {{ totalPrice }}</div>
              </div>
            </div>
            <div v-else style="color:var(--muted);padding:12px">No items were registered.</div>
          </div>

          <div class="summary-footer">
              Order Placed: {{ orderDateTime }}
          </div>

          <div style="display:flex;justify-content:flex-end;margin-top:20px;">
            <button class="place-order-btn" style="width:auto;padding:10px 20px;" @click="closeCheckout">Back to Clubs</button>
          </div>
        </div>
      </transition>
    </main>
  </div>

  <script>
    function getRandomStock() {
        // Returns a random integer between 2 and 5 (inclusive)
        return Math.floor(Math.random() * (5 - 2 + 1)) + 2;
    }

    // Vue.js Application
    new Vue({
      el:'#app',
      data:{
        currentCategory: 'subjects',
        showCheckout: false,
        showSummary: false,
        orderDateTime: null,

        order: { name:'', email:'', country:'United Arab Emirates', city:'', studentNumber:'', year:'' },
        cart: [], // Stores product IDs

        products: [
          // Items now include 'stock' and 'inCart' properties
          { id: 101, subject:'Mathematics', category:'Subjects', location:'Dubai', price:120, icon:'fas fa-calculator', stock: getRandomStock(), inCart: 0 },
          { id: 102, subject:'English Language', category:'Subjects', location:'Dubai', price:110, icon:'fas fa-book', stock: getRandomStock(), inCart: 0 },
          { id: 103, subject:'Science Lab', category:'Subjects', location:'Dubai', price:130, icon:'fas fa-flask', stock: getRandomStock(), inCart: 0 },
          { id: 104, subject:'Coding Club', category:'Subjects', location:'Dubai', price:180, icon:'fas fa-laptop-code', stock: getRandomStock(), inCart: 0 },
          { id: 105, subject:'Public Speaking', category:'Subjects', location:'Dubai', price:100, icon:'fas fa-microphone', stock: getRandomStock(), inCart: 0 },

          { id: 201, subject:'Football', category:'Sports', location:'Dubai', price:90, icon:'fas fa-futbol', stock: getRandomStock(), inCart: 0 },
          { id: 202, subject:'Basketball', category:'Sports', location:'Dubai', price:95, icon:'fas fa-basketball', stock: getRandomStock(), inCart: 0 },
          { id: 203, subject:'Tennis', category:'Sports', location:'Dubai', price:100, icon:'fas fa-table-tennis', stock: getRandomStock(), inCart: 0 },
          { id: 204, subject:'Swimming', category:'Sports', location:'Dubai', price:85, icon:'fas fa-person-swimming', stock: getRandomStock(), inCart: 0 },
          { id: 205, subject:'Martial Arts', category:'Sports', location:'Dubai', price:100, icon:'fas fa-hand-fist', stock: getRandomStock(), inCart: 0 },

          { id: 301, subject:'Music', category:'Activities', location:'Dubai', price:120, icon:'fas fa-music', stock: getRandomStock(), inCart: 0 },
          { id: 302, subject:'Robotics', category:'Activities', location:'Dubai', price:180, icon:'fas fa-robot', stock: getRandomStock(), inCart: 0 },
          { id: 303, subject:'Photography', category:'Activities', location:'Dubai', price:150, icon:'fas fa-camera', stock: getRandomStock(), inCart: 0 },
          { id: 304, subject:'Drama & Theatre', category:'Activities', location:'Dubai', price:130, icon:'fas fa-theater-masks', stock: getRandomStock(), inCart: 0 },
          { id: 305, subject:'Cooking', category:'Activities', location:'Dubai', price:140, icon:'fas fa-utensils', stock: getRandomStock(), inCart: 0 },
          { id: 306, subject:'Chess Club', category:'Activities', location:'Dubai', price:95, icon:'fas fa-chess', stock: getRandomStock(), inCart: 0 }
        ]
      },
      computed:{
        filteredProducts(){
          return this.products.filter(p => p.category.toLowerCase() === this.currentCategory);
        },
        cartItemCount(){ return this.cart.length; },
        cartDetails(){ return this.cart.map(id => this.products.find(p => p.id === id) ).filter(Boolean); },
        totalPrice(){ return this.cartDetails.reduce((s,i) => s + (i.price||0), 0); }
      },
      methods:{
        openCheckout(){
          this.showCheckout = true;
          this.showSummary = false;
        },
        closeCheckout(){
          // Reset cart and order data when returning to the club listings page
          if (this.showSummary) {
              alert(`✅ Order Confirmed. Thank you, ${this.order.name}! Your clubs will now be processed.`);
          }

          // Resetting stock status for products after order is confirmed/viewed.
          this.products.forEach(p => p.inCart = 0);
          
          this.cart = [];
          this.order = { name:'', email:'', country:'United Arab Emirates', city:'', studentNumber:'', year:'' };
          this.orderDateTime = null;
          this.showSummary = false;
          this.showCheckout = false;
        },

        getProductById(id) {
            return this.products.find(p => p.id === id);
        },

        addToCart(prod){
            if (this.canAddToCart(prod)) {
                this.cart.push(prod.id);
                prod.inCart++; // Increment count for this product
            } else {
                alert(`Cannot add more ${prod.subject}. Only ${prod.stock} slots available.`);
            }
        },
        
        removeFromCart(index){
            const prodIdToRemove = this.cart[index];
            const product = this.getProductById(prodIdToRemove);

            if (product) {
                product.inCart--; // Decrement count for this product
            }
            this.cart.splice(index,1);
        },

        canAddToCart(prod){
          // Check if the number of items of this product in the cart is less than its stock
          return prod.inCart < prod.stock;
        },

        confirmOrder(){
          if(!this.order.name || !this.order.email || !this.order.studentNumber || !this.order.city || !this.order.country || !this.order.year){
            alert('Please fill all required registration fields (Name, Email, Student Number, Year, Country & City).');
            return;
          }
          if(this.cart.length===0){
            alert('Please add at least one club before placing the order.');
            return;
          }

          this.orderDateTime = new Date().toLocaleString();

          this.showSummary = true;
          this.showCheckout = false;
        }
      }
    });
  </script>
</body>
</html>